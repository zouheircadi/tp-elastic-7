input {
    file {
        path => ["/Users/zouheir/elastic/tp-elastic/data/googleplaystore.100000.csv"]
        start_position => "beginning"
        sincedb_path => "/dev/null"
    }
}

filter {
    csv {
      columns => [
      "app_name",
      "category",
      "rating",
      "reviews",
      "size",
      "installs",
      "type",
      "price",
      "content_rating",
      "genres",
      "last_updated",
      "current_ver",
      "android_ver"
        ] 

      skip_header => true

      remove_field => ["message","host","path","@version"]
    }

  mutate {
    convert =>{
      "price" => "float"
      "rating" => "float"
      "reviews" => "integer"
    }
  }  

  date {
    match => ["last_updated", "MMM dd, YYYY"]
    target => "last_updated"    
  }  

}


output {
    stdout { codec => rubydebug }
    elasticsearch {
        hosts => ["192.168.1.10:10200"]
        ilm_enabled => true
        ilm_rollover_alias => "hwcd"
        ilm_pattern => "000001"
        ilm_policy => "hot-warm-cold-delete-1-policy"
        workers => 1
    }
}
