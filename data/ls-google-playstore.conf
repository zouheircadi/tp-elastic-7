input {
    file {
        path => ["<WORK_DIR>/tp-elastic/data/googleplaystore.csv"]
        start_position => "beginning"
        sincedb_path => "/dev/null"
    }
}

filter {
    csv {
      columns => [
      "app_name",
      "category",
      "rating",
      "reviews",
      "size",
      "installs",
      "type",
      "price",
      "content_rating",
      "genres",
      "last_updated",
      "current_ver",
      "android_ver"
        ] 

      skip_header => true

      remove_field => ["message","host","path","@version"]
    }

  mutate {
    convert =>{
      "price" => "float"
      "rating" => "float"
      "reviews" => "integer"
    }
  }  

  date {
    match => ["last_updated", "MMM dd, YYYY"]
    target => "last_updated"    
  }  

}


output {
    stdout { codec => rubydebug }
    elasticsearch {
        action => "index"
        hosts => ["localhost:9200"]
        index => "tp_elastic_gstore"
        workers => 1
    }
}